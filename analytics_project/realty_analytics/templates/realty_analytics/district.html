{% extends 'base.html' %}
{% load static %}
{% block title %}–†–∞–π–æ–Ω{% endblock %}
{% load humanize %}

    <!-- ======== –û–°–ù–û–í–ù–û–ï –°–û–î–ï–†–ñ–ò–ú–û–ï ======== -->
{% block content %}
    <!-- ======== –û–°–ù–û–í–ù–û–ï –°–û–î–ï–†–ñ–ò–ú–û–ï –°–¢–†–ê–ù–ò–¶–´ –†–ê–ô–û–ù–ê ======== -->
    <main>
        <div class="container">
            <!-- "–•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏" –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
            <nav class="breadcrumbs">
                <a href="{% url 'home' %}">–ì–ª–∞–≤–Ω–∞—è</a> ¬ª
                <a href="#">–ú–æ—Å–∫–≤–∞</a> ¬ª
                <a href="#">–¶–ê–û</a> ¬ª
                <span>–•–∞–º–æ–≤–Ω–∏–∫–∏</span>
            </nav>

            {% if is_accessible %}
            <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
            <div class="page-layout">
                <!-- –õ–µ–≤–∞—è, –æ—Å–Ω–æ–≤–Ω–∞—è –∫–æ–ª–æ–Ω–∫–∞ —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π -->
                <div class="main-content" data-district-id = "{{district_id}}">

                    <h1 class="page-title">{{ district.smart_name|default:district.name }}</h1>
                    <p class="page-subtitle">–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ü–µ–Ω, –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–æ–≥–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞ –æ–¥–Ω–æ–≥–æ –∏–∑ —Å–∞–º—ã—Ö –ø—Ä–µ—Å—Ç–∏–∂–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤ –ú–æ—Å–∫–≤—ã.</p>

                   <div class="data-block">
                        <h2 class="data-block-title">–ö–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ (–í—Ç–æ—Ä–∏—á–Ω—ã–π —Ä—ã–Ω–æ–∫)</h2>
                        {% if key_metrics %}
                            <table class="data-table">
                                <tr>
                                    <td>–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –º¬≤ –≤ {{ key_metrics.month_name }}</td>
                                    <td><strong>{{ key_metrics.avg_price|floatformat:0|intcomma }} ‚ÇΩ</strong></td>
                                </tr>
                                <tr>
                                    <td>–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞ –º–µ—Å—è—Ü</td>
                                    <td class="{% if '+' in key_metrics.change %}text-positive{% else %}text-negative{% endif %}">
                                        {% if '+' in key_metrics.change %}‚Üó{% elif '-' in key_metrics.change %}‚Üò{% endif %}
                                        {{ key_metrics.change }}
                                    </td>
                                </tr>
                                <!-- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ -->
                            </table>
                        {% else %}
                            <p>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–ª—é—á–µ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π.</p>
                        {% endif %}
                    </div>

                    <div class="data-block">
                        <h2 class="data-block-title">–î–∏–Ω–∞–º–∏–∫–∞ —Ü–µ–Ω (–í—Ç–æ—Ä–∏—á–Ω—ã–π —Ä—ã–Ω–æ–∫)</h2>
                        <div class="chart-container">
                            <!-- –î–æ–±–∞–≤–ª—è–µ–º ID –∏ data-–∞—Ç—Ä–∏–±—É—Ç—ã, —á—Ç–æ–±—ã –Ω–∞—à JS –º–æ–≥ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫ -->
                            <canvas id="district-chart"
                                    data-zonen-id="{{ district.zonen_id }}"
                                    data-property-type="secondary"
                                    data-property-class="vall">
                            </canvas>
                        </div>
                    </div>

                    <!-- ... –ø–æ—Å–ª–µ –±–ª–æ–∫–∞ <div class="data-block"> —Å –ø–µ—Ä–≤—ã–º –≥—Ä–∞—Ñ–∏–∫–æ–º ... -->

                    <div class="data-block">
                        <h2 class="data-block-title">–î–∏–Ω–∞–º–∏–∫–∞ –ø–æ –∫–ª–∞—Å—Å–∞–º –∂–∏–ª—å—è (–í—Ç–æ—Ä–∏—á–Ω—ã–π —Ä—ã–Ω–æ–∫)</h2>
                        <div class="chart-container">
                            <!-- –ù–æ–≤—ã–π canvas —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º ID –∏ data-–∞—Ç—Ä–∏–±—É—Ç–∞–º–∏ -->
                            <canvas id="class-dynamics-chart"
                                    data-zonen-id="{{ district.zonen_id }}"
                                    data-property-type="secondary"></canvas>
                        </div>
                    </div>

                    <div class="data-block">
                        <h2 class="data-block-title">–ö–∞—Ä—Ç–∞</h2>
                        <div id="district-map" class="sidebar-map"
                         data-geometry='{{ district_geometry_json }}'
                         data-name="{{ district.smart_name|default:district.name }}"></div>
                    </div>
                </div>


                <!-- ======== –ë–õ–û–ö –î–õ–Ø –ì–†–ê–§–ò–ö–ê –î–ò–ù–ê–ú–ò–ö–ò –¶–ï–ù ======== -->



                <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ (—Å–∞–π–¥–±–∞—Ä) -->
                <aside class="sidebar">
                    <div class="sidebar-widget">
                        <h3 class="sidebar-title">–ö–∞—Ä—Ç–∞ —Ä–∞–π–æ–Ω–∞</h3>
                        <div class="placeholder-chart sidebar-map">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞ —Ä–∞–π–æ–Ω–∞ –•–∞–º–æ–≤–Ω–∏–∫–∏</div>
                    </div>
                    <div class="sidebar-widget">
                         <h3 class="sidebar-title">–ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç</h3>
                         <p>–ü–æ–ª—É—á–∏—Ç–µ –ø–æ–ª–Ω—ã–π PDF-–æ—Ç—á–µ—Ç –ø–æ —Ä–∞–π–æ–Ω—É —Å –≤—ã–≥—Ä—É–∑–∫–æ–π –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö.</p>
                         <a href="#" class="cta-button">–°–∫–∞—á–∞—Ç—å –∑–∞ 990 ‚ÇΩ</a>
                    </div>
                </aside>
            </div>
            {% else %}
                 <!-- –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨ –ù–ï –ò–ú–ï–ï–¢ –î–û–°–¢–£–ü–ê - –ü–û–ö–ê–ó–´–í–ê–ï–ú PAYWALL -->
            <div class="paywall-container">
                <h1 class="page-title">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ä–∞–π–æ–Ω–∞ {{ district.name }}</h1>
                <h2>üîí –≠—Ç–æ –ø–ª–∞—Ç–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç</h2>
                <p>–ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –¥–µ—Ç–∞–ª—å–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–µ –ø–æ —Ä–∞–π–æ–Ω–∞–º, –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º –∫–∞—Ä—Ç–∞–º, –≥—Ä–∞—Ñ–∏–∫–∞–º –∏ –≤—ã–≥—Ä—É–∑–∫–µ –æ—Ç—á–µ—Ç–æ–≤ –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–æ–π.</p>
                <a href="{% url 'tariffs' %}" class="cta-button">–£–∑–Ω–∞—Ç—å –æ —Ç–∞—Ä–∏—Ñ–∞—Ö</a>
            </div>
          {% endif %}

        </div>
    </main>

  {% endblock %}